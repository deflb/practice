(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{678:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return j});a(527);var n=a(528),s=a.n(n),o=a(87),c=a(542),i=(a(548),a(549)),r=a.n(i),d=a(81),l=a(82),g=a(84),u=a(83),m=a(85),h=a(2),_=a.n(h),p=a(32),f=a.n(p),v=a(594),b=a(41),w=a(112),E=a(86),O=a(38),S=a(679),N=a.n(S),R=Object(b.a)(function(){return a.e(29).then(a.bind(null,692))}),j=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(a=Object(g.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={pageNo:1,pageSize:10,hasMore:!0,dataBlobs:[],dataSource:new r.a.DataSource({rowHasChanged:function(e,t){return e!==t}}),isLoading:!1,height:0},a.getMessages=function(){var e=a.state,t=e.pageNo,n=e.pageSize,s=e.dataBlobs,o=e.dataSource;a.setState({isLoading:!0}),Object(w.a)({url:E.a.getMessages,data:{pageNo:t,pageSize:n}}).then(function(e){var t=e.list,n=e.pageTurn,i=n.nextPage,r=n.rowCount,d=Object(c.a)(s).concat(Object(c.a)(t));a.setState({dataBlobs:d,hasMore:!(d.length>=r),pageNo:i,dataSource:o.cloneWithRows(d),isLoading:!1})}).catch(function(e){a.setState({isLoading:!1})})},a.onEndReached=function(e){var t=a.state,n=t.isLoading,s=t.hasMore;!n&&s&&a.getMessages()},a.goToDetail=function(e,t){"0"===e.isRead&&Object(w.a)({url:E.a.updateMessageRead,data:{msgId:e.msgId}}).then(function(e){var n=a.state,s=n.dataBlobs,i=n.dataSource,r=Object(c.a)(s),d=Object(o.a)({},r[t]);d.isRead="1",r.splice(t,1,d),a.setState({dataBlobs:r,dataSource:i.cloneWithRows(r)})}).catch(function(e){});var n=a.props,s=n.history,i=n.match;s.push({pathname:i.path+"/detail",state:e})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=document.documentElement.clientHeight-f.a.findDOMNode(this.lv).getBoundingClientRect().top;this.setState({height:e}),this.getMessages()}},{key:"render",value:function(){var e=this,t=this.state,a=t.dataSource,n=t.height,o=this.props.match;return _.a.createElement("div",{className:"bg_grey_list_view"},_.a.createElement(r.a,{ref:function(t){return e.lv=t},dataSource:a,renderRow:function(t,a,n){return _.a.createElement("div",null,_.a.createElement("div",{className:N.a.message_time},_.a.createElement("span",null,Object(O.b)(new Date(t.msgDate)))),_.a.createElement(s.a,{full:!0,className:N.a.message_content},_.a.createElement(s.a.Header,{title:_.a.createElement("div",{className:"oneRowsOverflowOmit"},t.msgTitle),extra:_.a.createElement("span",{className:"0"===t.isRead?N.a.message_content_noread:N.a.message_content_isread})}),_.a.createElement(s.a.Body,null,_.a.createElement("p",{className:"twoRowsOverflowOmit"},t.msgContent)),_.a.createElement(s.a.Footer,{extra:_.a.createElement("div",{className:N.a.message_content_view,onClick:e.goToDetail.bind(e,t,n)},"\u67e5\u770b\u8be6\u60c5")})))},style:{height:n},onEndReached:this.onEndReached,onEndReachedThreshold:30}),_.a.createElement(v.a,{path:o.path+"/detail",component:R}))}}]),t}(h.Component)},679:function(e,t,a){e.exports={message_time:"index_message_time__3OUfK",message_content_noread:"index_message_content_noread__2hPND",message_content_isread:"index_message_content_isread__2PJIa",message_content_view:"index_message_content_view__1MLNy"}}}]);
//# sourceMappingURL=20.2c921047.chunk.js.map