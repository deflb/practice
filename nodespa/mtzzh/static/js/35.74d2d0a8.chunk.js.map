{"version":3,"sources":["component/customImageUpload/index.js","view/myAfterSale/apply/index.js","view/myAfterSale/apply/apply.less"],"names":["customImageUpload","onChange","fileList","type","index","_this$props","_this","props","files","maxLength","changeHandle","len","length","uploadRow","formData","FormData","append","file","request","url","api","fileUpload","data","config","baseURL","fileaddress","then","res","Object","E_mtzzh_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__","concat","E_mtzzh_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","fileUrl","catch","err","fileDelete","_files","splice","react__WEBPACK_IMPORTED_MODULE_9___default","a","createElement","antd_mobile_lib_image_picker__WEBPACK_IMPORTED_MODULE_1___default","assign","multiple","accept","this","Component","defaultProps","apply","state","BaseDataList","PickerValue","storeId","textareaValue","init","getBaseDataList","arr","forEach","item","push","label","fdesc","value","fcode","setState","console","log","sqOk","val","commit","_this$state","datePickerValue","imgList","custproblem","fasksettledate","String","getTime","fclmtypeid","fordid","_this2","_this$state2","react__WEBPACK_IMPORTED_MODULE_17___default","className","styles","antd_mobile_lib_input_item__WEBPACK_IMPORTED_MODULE_11___default","e","antd_mobile_lib_picker__WEBPACK_IMPORTED_MODULE_7___default","onOk","cols","antd_mobile_lib_list__WEBPACK_IMPORTED_MODULE_9___default","Item","arrow","mb8","antd_mobile_lib_date_picker__WEBPACK_IMPORTED_MODULE_5___default","antd_mobile_lib_textarea_item__WEBPACK_IMPORTED_MODULE_3___default","placeholder","data-seed","ref","el","autoFocusInst","autoHeight","_component_customImageUpload__WEBPACK_IMPORTED_MODULE_19__","selectable","paddingbox","antd_mobile_lib_button__WEBPACK_IMPORTED_MODULE_1___default","onClick","module","exports"],"mappings":"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","file":"static/js/35.74d2d0a8.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { ImagePicker } from 'antd-mobile';\r\nimport { request } from '../../request';\r\nimport api from '../../request/api';\r\nimport { fileaddress } from '../../request/baseURL';\r\n\r\nexport default class customImageUpload extends Component {\r\n\r\n    static propTypes = {\r\n        maxLength: PropTypes.number,\r\n        changeHandle: PropTypes.func,\r\n    }\r\n\r\n    static defaultProps = {\r\n        maxLength: 10,\r\n        changeHandle: function () { }\r\n    }\r\n\r\n    onChange = (fileList, type, index) => {\r\n        let { files, maxLength, changeHandle } = this.props,\r\n            len = fileList.length;\r\n        if (len > maxLength) return\r\n        if (type === 'add') {\r\n            let uploadRow = fileList[len - 1], formData = new FormData();\r\n            formData.append('file', uploadRow.file)\r\n            request({\r\n                url: api.fileUpload, data: formData,\r\n                config: {\r\n                    baseURL: fileaddress\r\n                }\r\n            }).then(res => {\r\n                changeHandle([\r\n                    ...this.props.files, // 获取已更新的 (onChange 的循环执行在同步执行栈 ajax,setState为异步任务在事件队列)\r\n                    { ...res, url: uploadRow.url, fileUrl: res.url }\r\n                ])\r\n            }).catch(err => { })\r\n        }\r\n        if (type === 'remove')\r\n            request({\r\n                url: api.fileDelete, data: { url: files[index].fileUrl },\r\n                config: {\r\n                    baseURL: fileaddress\r\n                }\r\n            }).then(res => {\r\n                let _files = [...this.props.files];  // 同上\r\n                _files.splice(index, 1);\r\n                changeHandle(_files)\r\n            }).catch(err => { })\r\n    }\r\n    render() {\r\n        return <ImagePicker\r\n            multiple\r\n            accept=\"image/*,video/*\"\r\n            {...this.props}\r\n            onChange={this.onChange}\r\n        />\r\n    }\r\n}","import React, { Component } from 'react';\r\nimport { ImagePicker,TextareaItem ,Form\r\n    ,Picker,InputItem, List,DatePicker, Button } from 'antd-mobile';\r\nimport styles  from './apply.less';\r\nimport CustomImageUpload from '../../../component/customImageUpload';\r\n// import { connect } from 'react-redux';\r\nimport { request } from '../../../request';\r\nimport api from '../../../request/api';\r\n// const FormTaskApply = Form.create()(taskApply);\r\nexport default class apply extends Component {\r\n    state = {\r\n        files:[],\r\n        multiple:true,\r\n        BaseDataList:[],\r\n        PickerValue:'',\r\n        storeId:'',\r\n        textareaValue:''\r\n    }\r\n    componentDidMount(){\r\n        this.init()\r\n    }\r\n    init=()=>{\r\n          //获取下拉\r\n          request({ url: api.getBaseDataList,\r\n                    data: { type:'CRM140_fClmTypeID' }\r\n             }).then(res => {\r\n            let arr =[];\r\n            res.forEach((item,index)=>{\r\n                arr.push({\r\n                    label:item.fdesc,\r\n                    value:item.fcode\r\n                })\r\n            })\r\n            this.setState({ BaseDataList: arr })\r\n        }).catch(err => { console.log(err) })\r\n    }\r\n    onChange = (files, type, index) => {\r\n        console.log(files, type, index);\r\n        this.setState({\r\n          files,\r\n        });\r\n      }\r\n      sqOk =(val)=>{\r\n       \r\n        this.setState({PickerValue:val})\r\n      }\r\n      commit =()=>{\r\n        let url =\"/storejps/claim/save\",\r\n            {storeId,PickerValue,datePickerValue,textareaValue,files} =this.state;\r\n        let imgList = [];\r\n        files.forEach(item=>{\r\n            imgList.push(item.fileUrl)\r\n        })\r\n         let data={\r\n                custproblem:textareaValue,\r\n                fasksettledate:String(datePickerValue.getTime()),\r\n                fclmtypeid:PickerValue,\r\n                fordid:storeId,\r\n                imgList:imgList\r\n            };\r\n        request({url,data}).then(res=>{\r\n            \r\n        })\r\n      }\r\n    render() {\r\n        let {files,storeId,datePickerValue,textareaValue} = this.state;\r\n        \r\n        return (\r\n            <div className={styles.apply}>   \r\n                <div className={styles.item}><InputItem value={storeId} onChange={(e)=>{\r\n                    this.setState({\r\n                        storeId:e\r\n                    })                }}>订单号</InputItem></div>\r\n                <div className={styles.item}>\r\n                        <Picker data={this.state.BaseDataList} \r\n                        value = {this.state.PickerValue}\r\n                        onOk={this.sqOk}\r\n                        cols ={1} >\r\n                            <List.Item arrow=\"horizontal\">\r\n                                诉求\r\n                            </List.Item>\r\n                        </Picker>\r\n                    </div>\r\n                <div className={styles.item +\" \"+styles.mb8}>\r\n                        <DatePicker data={this.state.BaseDataList} \r\n                        value={datePickerValue}\r\n                        onChange={(e)=>{\r\n                            this.setState({datePickerValue:e})\r\n                        }}>\r\n                            <List.Item arrow=\"horizontal\">\r\n                                要求完成日期\r\n                            </List.Item>\r\n                        </DatePicker></div>\r\n                <div className={styles.item}>\r\n                    <List.Item >问题描述\r\n                    <TextareaItem\r\n                        placeholder=\"请输入问题描述\"\r\n                        data-seed=\"logId\"\r\n                        value={textareaValue}\r\n                        onChange = {(e)=>{\r\n                            this.setState({textareaValue:e})\r\n                        }}\r\n                        ref={el => this.autoFocusInst = el}\r\n                        autoHeight\r\n                    />\r\n                    </List.Item>\r\n                </div>\r\n                <div className={styles.item}>\r\n                <List.Item >\r\n                拍照上传<span>({files.length}/10)</span>\r\n                \r\n                    <CustomImageUpload\r\n                            maxLength={10}\r\n                            changeHandle={(val) => {\r\n                                this.setState({\r\n                                    files: val\r\n                                })\r\n                            }}\r\n                            selectable={files.length < 10}\r\n                            files={files}\r\n                        />\r\n\r\n                    </List.Item>\r\n                </div>\r\n                <div className={styles.paddingbox}><Button type=\"primary\" onClick={this.commit}>提交</Button></div>\r\n            </div>\r\n        );\r\n    }\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"apply\":\"apply_apply__1soCr\",\"item\":\"apply_item__3A6Nk\",\"mb8\":\"apply_mb8__cV_Od\",\"paddingbox\":\"apply_paddingbox__3yqy8\"};"],"sourceRoot":""}