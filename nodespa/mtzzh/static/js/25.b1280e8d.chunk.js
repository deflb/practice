(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{792:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return y});a(571);var n=a(572),s=a.n(n),o=(a(533),a(534)),c=a.n(o),i=a(90),r=a(540),d=(a(552),a(553)),l=a.n(d),u=a(85),g=a(86),h=a(88),m=a(87),p=a(89),_=a(2),f=a.n(_),b=a(33),v=a.n(b),w=a(247),E=a(41),O=a(53),S=a(47),R=a(40),N=a(793),j=a.n(N),M=Object(E.a)(function(){return a.e(41).then(a.bind(null,863))}),y=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={pageNo:1,pageSize:10,hasMore:!0,dataBlobs:[],dataSource:new l.a.DataSource({rowHasChanged:function(e,t){return e!==t}}),isLoading:!1,height:0},a.getMessages=function(){var e=a.state,t=e.pageNo,n=e.pageSize,s=e.dataBlobs,o=e.dataSource;a.setState({isLoading:!0}),Object(O.a)({url:S.a.getMessages,data:{pageNo:t,pageSize:n}}).then(function(e){var t=e.list,n=e.pageTurn,c=n.nextPage,i=n.rowCount,d=Object(r.a)(s).concat(Object(r.a)(t));a.setState({dataBlobs:d,hasMore:!(d.length>=i),pageNo:c,dataSource:o.cloneWithRows(d),isLoading:!1})}).catch(function(e){a.setState({isLoading:!1})})},a.updateList=function(){var e=a.state,t=e.dataBlobs,n=e.dataSource,s=t.length;Object(O.a)({url:S.a.getMessages,data:{pageNo:1,pageSize:s}}).then(function(e){var t=e.list,s=e.pageTurn.rowCount;a.setState({hasMore:!(t.length>=s),dataBlobs:t,dataSource:n.cloneWithRows(t)})}).catch(function(e){})},a.onEndReached=function(e){var t=a.state,n=t.isLoading,s=t.hasMore;!n&&s&&a.getMessages()},a.goToDetail=function(e,t){"0"===e.isRead&&Object(O.a)({url:S.a.updateMessageRead,data:{msgId:e.msgId}}).then(function(e){var n=a.state,s=n.dataBlobs,o=n.dataSource,c=Object(r.a)(s),d=Object(i.a)({},c[t]);d.isRead="1",c.splice(t,1,d),a.setState({dataBlobs:c,dataSource:o.cloneWithRows(c)})}).catch(function(e){});var n=a.props,s=n.history,o=n.match;s.push({pathname:o.path+"/detail",state:e})},a}return Object(p.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=document.documentElement.clientHeight-v.a.findDOMNode(this.lv).getBoundingClientRect().top;this.setState({height:e}),this.getMessages()}},{key:"render",value:function(){var e=this,t=this.state,a=t.dataSource,n=t.height,o=t.isLoading,i=this.props.match;return f.a.createElement("div",{className:"bg_grey_list_view"},f.a.createElement(l.a,{ref:function(t){return e.lv=t},dataSource:a,renderRow:function(t,a,n){return f.a.createElement("div",null,f.a.createElement("div",{className:j.a.message_time},f.a.createElement("span",null,Object(R.b)(new Date(t.msgDate)))),f.a.createElement(c.a,{full:!0,className:j.a.message_content},f.a.createElement(c.a.Header,{title:f.a.createElement("div",{className:"oneRowsOverflowOmit"},t.msgTitle),extra:f.a.createElement("span",{className:"0"===t.isRead?j.a.message_content_noread:j.a.message_content_isread})}),f.a.createElement(c.a.Body,null,f.a.createElement("p",{className:"twoRowsOverflowOmit"},t.msgContent)),f.a.createElement(c.a.Footer,{extra:f.a.createElement("div",{className:j.a.message_content_view,onClick:e.goToDetail.bind(e,t,n)},"\u67e5\u770b\u8be6\u60c5")})))},style:{height:n},onEndReached:this.onEndReached,onEndReachedThreshold:60,pullToRefresh:f.a.createElement(s.a,{refreshing:o,direction:"down",distanceToRefresh:40,onRefresh:this.updateList})}),f.a.createElement(w.a,{path:i.path+"/detail",component:M}))}}]),t}(_.Component)},793:function(e,t,a){e.exports={message_time:"index_message_time__3OUfK",message_content_noread:"index_message_content_noread__2hPND",message_content_isread:"index_message_content_isread__2PJIa",message_content_view:"index_message_content_view__1MLNy"}}}]);
//# sourceMappingURL=25.b1280e8d.chunk.js.map