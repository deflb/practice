{"version":3,"sources":["../node_modules/@babel/runtime/helpers/esm/extends.js","../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","component/noResult/index.js","view/nearbyShop/index.less","view/nearbyShop/index.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","__webpack_require__","d","__webpack_exports__","_toConsumableArray","arr","Array","isArray","arr2","_arrayWithoutHoles","iter","Symbol","iterator","toString","from","_iterableToArray","TypeError","_nonIterableSpread","_ref","_props$message","E_mtzzh_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__","message","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","className","style","textAlign","module","exports","wrapper","wrapper_list","wrapper_list_item","wrapper_list_item_title","wrapper_list_item_title_pos","wrapper_list_item_title_pos_tip","wrapper_list_item_address","Detail","asyncC","e","then","bind","nearbyShop","state","pageNo","pageSize","hasMore","dataBlobs","dataSource","antd_mobile_lib_list_view__WEBPACK_IMPORTED_MODULE_2___default","DataSource","rowHasChanged","row1","row2","isLoading","height","goToDetail","rowData","_this$props","_this","props","history","match","push","pathname","path","getNearShop","_this$state","request","url","api","nearShop","data","distance","flatitude","flongitude","res","list","pageTurn","nextPage","rowCount","sort","b","isNear","_dataBlobs","E_mtzzh_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","concat","setState","cloneWithRows","catch","err","onEndReached","event","_this$state2","hei","document","documentElement","clientHeight","ReactDOM","findDOMNode","lv","getBoundingClientRect","top","_this2","_this$state3","react__WEBPACK_IMPORTED_MODULE_8___default","styles","id","ref","el","renderHeader","_component_noResult__WEBPACK_IMPORTED_MODULE_12__","renderRow","sectionID","index","onClick","fsname","toFixed","faddress","onEndReachedThreshold","react_router__WEBPACK_IMPORTED_MODULE_10__","component","Component"],"mappings":"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","file":"static/js/14.d2d9cf20.chunk.js","sourcesContent":["export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","import arrayWithoutHoles from \"./arrayWithoutHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport nonIterableSpread from \"./nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}","export default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}","export default function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}","import React from 'react';\r\n\r\nexport default ({ ...props }) => {\r\n    const { message = '无结果' } = props;\r\n    return <div className='normalFontSizeC shallowGreyColor' style={{ textAlign: 'center' }}>{message}</div>\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"index_wrapper__2FJ6t\",\"wrapper_list\":\"index_wrapper_list__ZrwYI\",\"wrapper_list_item\":\"index_wrapper_list_item__2jLe5\",\"wrapper_list_item_title\":\"index_wrapper_list_item_title__3klnW\",\"wrapper_list_item_title_pos\":\"index_wrapper_list_item_title_pos__2GJVt\",\"wrapper_list_item_title_pos_tip\":\"index_wrapper_list_item_title_pos_tip__2laQU\",\"wrapper_list_item_address\":\"index_wrapper_list_item_address__bh7cB\"};","import React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\n// import BMap from 'BMap';\r\nimport { Route } from 'react-router';\r\nimport { ListView } from 'antd-mobile';\r\nimport asyncC from '../../component/asyncC';\r\nimport NoResult from '../../component/noResult';\r\n// import { wx, wx_config } from '../../utlis/wxConfig';\r\nimport { request } from '../../request';\r\nimport api from '../../request/api';\r\nimport styles from './index.less';\r\nconst Detail = asyncC(() => import('./detail'));\r\n\r\nexport default class nearbyShop extends Component {\r\n    state = {\r\n        pageNo: 1,\r\n        pageSize: 10,\r\n        hasMore: true,\r\n        dataBlobs: [],\r\n        dataSource: new ListView.DataSource({\r\n            rowHasChanged: (row1, row2) => row1 !== row2\r\n        }),\r\n        isLoading: false,\r\n        height: 0,\r\n    }\r\n    goToDetail = rowData => {\r\n        const { history, match } = this.props;\r\n        history.push({\r\n            pathname: match.path + '/detail',\r\n            state: rowData\r\n        })\r\n    }\r\n\r\n    getNearShop = () => {\r\n        const { pageNo, pageSize, dataBlobs, dataSource } = this.state;\r\n        request({ url: api.nearShop, data: { distance: 5, flatitude: 23.132456, flongitude: 113.378585, pageNo, pageSize } }).then(res => {\r\n            const { list, pageTurn } = res,\r\n                { nextPage, rowCount } = pageTurn;\r\n            list.sort((a, b) => a.distance - b.distance)\r\n            list[0].isNear = 1; // 加入最近标记\r\n            const _dataBlobs = [...dataBlobs, ...list];\r\n            this.setState({\r\n                hasMore: _dataBlobs.length >= rowCount ? false : true,\r\n                pageNo: nextPage,\r\n                dataBlobs: _dataBlobs,\r\n                dataSource: dataSource.cloneWithRows([..._dataBlobs]),\r\n                isLoading: false,\r\n            })\r\n        }).catch(err => { this.setState({ isLoading: false }) })\r\n    }\r\n\r\n    componentDidMount() {\r\n        const hei = document.documentElement.clientHeight - ReactDOM.findDOMNode(this.lv).getBoundingClientRect().top;\r\n        this.setState({ height: hei })\r\n        this.getNearShop();\r\n\r\n        // wx_config({ jsApiList: ['getLocation'] }).then(res => { // 地图展示用 百度地图jsApi\r\n        //     console.log(res)\r\n        //     // wx.getLocation({\r\n        //     //     type: 'wgs84', // 默认为wgs84的gps坐标，如果要返回直接给openLocation用的火星坐标，可传入'gcj02'\r\n        //     //     success: function (res) {\r\n        //     //         var ggPoint = new BMap.Point(res.longitude, res.latitude);\r\n        //     //         //地图初始化\r\n        //     //         var bm = new BMap.Map(\"map\");\r\n        //     //         bm.centerAndZoom(ggPoint, 18);\r\n        //     //         bm.addControl(new BMap.NavigationControl());\r\n        //     //         bm.addControl(new BMap.OverviewMapControl());\r\n        //     //         bm.addControl(new BMap.ScaleControl());\r\n        //     //         bm.addControl(new BMap.MapTypeControl());\r\n        //     //         bm.addControl(new BMap.CopyrightControl());\r\n        //     //         bm.addControl(new BMap.GeolocationControl());\r\n\r\n        //     //         var convertor = new BMap.Convertor();\r\n        //     //         var pointArr = [];\r\n        //     //         pointArr.push(ggPoint);\r\n        //     //         convertor.translate(pointArr, 1, 5, (data) => {\r\n        //     //             if (data.status === 0) {\r\n        //     //                 const pos = data.points[0];\r\n        //     //                 var marker = new BMap.Marker(pos);\r\n        //     //                 bm.addOverlay(marker);\r\n        //     //                 // var label = new BMap.Label(\"当前位置\", { offset: new BMap.Size(20, -10) });\r\n        //     //                 // marker.setLabel(label); //添加百度label\r\n        //     //                 bm.setCenter(pos);\r\n\r\n        //     //                 var myGeo = new BMap.Geocoder();\r\n        //     //                 // 根据坐标得到地址描述\r\n        //     //                 myGeo.getLocation(new BMap.Point(pos.lng, pos.lat), function (result) {\r\n        //     //                     if (result) {\r\n        //     //                         console.log(result)\r\n        //     //                     }\r\n        //     //                 });\r\n        //     //             }\r\n        //     //         })\r\n        //     //     }\r\n        //     // });\r\n        // }).catch(err => { console.log(err) })\r\n    }\r\n\r\n    onEndReached = (event) => {\r\n        const { isLoading, hasMore } = this.state;\r\n        if (isLoading || !hasMore)\r\n            return;\r\n        this.getNearShop()\r\n    }\r\n\r\n    render() {\r\n        const { dataBlobs, dataSource, height } = this.state,\r\n            { match } = this.props;\r\n        return (\r\n            <div className={styles.wrapper}>\r\n                <div id='map'></div>\r\n                <ListView\r\n                    className={`${styles.wrapper_list} list_view_maybe_comon`}\r\n                    ref={el => this.lv = el}\r\n                    dataSource={dataSource}\r\n                    renderHeader={() => dataBlobs.length ? null : <NoResult />}\r\n                    renderRow={(rowData, sectionID, index) => <ul className={styles.wrapper_list_item} onClick={this.goToDetail.bind(this, rowData)}>\r\n                        <li className={styles.wrapper_list_item_title}><span className={styles.wrapper_list_item_title_pos}>{rowData.fsname}{rowData.isNear === 1 ? <span className={styles.wrapper_list_item_title_pos_tip}>离你最近</span> : null}</span>{rowData.distance.toFixed(1)}km</li>\r\n                        <li className={styles.wrapper_list_item_address}><i className='iconfont icon-address' />{rowData.faddress}</li>\r\n                    </ul>}\r\n                    style={{\r\n                        height\r\n                    }}\r\n                    onEndReached={this.onEndReached}\r\n                    onEndReachedThreshold={30}\r\n                />\r\n                <Route path={match.path + '/detail'} component={Detail} />\r\n            </div>\r\n        );\r\n    }\r\n}"],"sourceRoot":""}